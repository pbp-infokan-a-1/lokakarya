{% extends 'base.html' %}
{% load static %}
{% block title %}{{ product.name }}{% endblock %}

{% block content %}
  <!-- Swiper CSS & JS -->
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  
  <div style="padding: 100px;">
    <!-- Hero Section -->
    <div class="container mx-auto p-4 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="flex flex-col justify-center">
        <!-- Image Slider -->
        <div class="overflow-hidden">
          <img src="{% static 'avatars/defaults.jpeg' %}" alt="Product Image" class="w-full object-cover rounded-lg">
        </div>
      </div>
        
    <!-- Product Information Panel -->
    <div class="flex flex-col justify-center p-4">
      <h5 class="text-md text-gray-700">{{product.category}}</h5>
      <h1 class="text-2xl font-bold text-gray-900 mb-2">{{product.name}}</h1>

      <hr class="my-4 border-t border-gray-500">
      
      <p class="text-sm text-gray-700">Rp.{{product.min_price}} - Rp.{{product.max_price}}</p>
      <p class="text-md mt-4">{{product.description}}</p>
      
      <!-- Rating Stars -->
      <hr class="my-4 border-t border-gray-500">
      <div class="mt-4">
        <p class="text-lg font-bold text-gray-700">Rating</p>
        <div>
          <div class="flex items-center gap-2 font-bold text-blue-gray-500">
            {{ product.count_average_rating|floatformat:1 }} <!-- Display average rating with one decimal -->
            <div class="inline-flex items-center">
      
              <!-- Render filled stars based on average rating -->
              {% for i in "12345"|make_list %}
                {% if i <= product.count_average_rating|floatformat:0 %}
                  <span>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                      class="w-6 h-6 text-yellow-700 cursor-pointer">
                      <path fill-rule="evenodd"
                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z"
                        clip-rule="evenodd"></path>
                    </svg>
                  </span>
                {% else %}
                  <span>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                      class="w-6 h-6 cursor-pointer text-blue-gray-500">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z">
                      </path>
                    </svg>
                  </span>
                {% endif %}
              {% endfor %}
            </div>
            <p class="block font-sans text-base antialiased font-medium leading-relaxed text-blue-gray-500">
              Based on {{ product.num_reviews }} Reviews
            </p>
          </div>
        </div>
      </div>

      <!-- Add Favorite -->
      <div class="flex space-x-4 mt-6">
          <button class="border border-gray-300 py-2 px-4 rounded-lg hover:bg-gray-200"> Add to Favourites</button>
      </div>
    </div>
  </div>

    <!-- Benefits Section -->
    <div class="container mx-auto py-8">
      <h2 class="text-xl font-bold mb-4">Affiliated Stores</h2>
      <div class="container mx-auto bg-gray-50 shadow-lg rounded-lg p-4">
        <ul class="list-disc pl-5 space-y-2">
          {% for store in matching_stores %}
            <a href="#"><li>{{ store.nama }}</li></a>
          
          {% endfor %}
        </ul>
      </div>
    </div>

    <!-- Reviews Section -->
    <div class="container mx-auto py-8">
      <h2 class="text-xl font-bold mb-4">Customer Reviews</h2>
      <div class="bg-white shadow-lg rounded-lg p-4">
        <p class="text-sm text-gray-600">No reviews yet.</p>
      </div>
    </div>

    <!-- Similar Products Section -->
    <div class="container mx-auto py-8">
      <h2 class="text-xl font-bold mb-4">You May Also Like</h2>
      <div class="swiper-container relative">
        
          <!-- Swiper Wrapper -->
          <div class="swiper-wrapper">
              {% for same_product in same_category_products %}
              <div class="swiper-slide bg-white">
                  <div class="bg-white shadow-md rounded-lg overflow-hidden">
                      <img src="{% static 'avatars/defaults.jpeg' %}" alt="{{ same_product.name }}" class="w-full object-cover">
                      <div class="p-4">
                          <h3 class="text-lg font-bold">{{ same_product.name }}</h3>
                          <p class="text-sm text-gray-600">IDR {{ same_product.min_price }} - {{ same_product.max_price }}</p>
                          <a href="{% url 'productpage:product_detail' same_product.id %}" class="text-blue-500">View Product</a>
                      </div>
                  </div>
              </div>
              {% endfor %}
          </div>
  
          <!-- Navigation Buttons -->
          <div class="swiper-button-next text-gray-700 absolute right-2 top-1/2 transform -translate-y-1/2"></div>
          <div class="swiper-button-prev text-gray-700 absolute left-2 top-1/2 transform -translate-y-1/2"></div>
      </div>
    </div>
  </div>

  
  <script>
    var swiper = new Swiper('.swiper-container', {
        slidesPerView: 5,  // Adjust the number of slides visible at once
        spaceBetween: 20,  // Space between slides
        loop: true,  // Enable continuous loop mode
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        breakpoints: {
            640: {
                slidesPerView: 1,
                spaceBetween: 10,
            },
            768: {
                slidesPerView: 2,
                spaceBetween: 15,
            },
            1024: {
                slidesPerView: 5,
                spaceBetween: 20,
            },
        },
    });
  </script>
{% endblock %}